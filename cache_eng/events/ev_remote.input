# Lines beginning with '#' are comments

# Request insertions in the CHA's TOR (Table of Requests), in the
# RRQ (Remote Request Queue). Read requests from remote sockets.
CHA TOR_INSERTS 0x40 0x0E803FF RRQ.RD_CUR
CHA TOR_INSERTS 0x40 0x0E80BFF RRQ.RD_CODE
CHA TOR_INSERTS 0x40 0x0E813FF RRQ.RD_DATA
CHA TOR_INSERTS 0x40 0x0E81BFF RRQ.RD_DATA_MIG
CHA TOR_INSERTS 0x40 0x0E823FF RRQ.INV_OWN
CHA TOR_INSERTS 0x40 0x0E82BFF RRQ.INV_X_TO_I
CHA TOR_INSERTS 0x40 0x0C43BFF RRQ.INV_I_TO_E
CHA TOR_INSERTS 0x40 0x0E863FF RRQ.RD_INV
CHA TOR_INSERTS 0x40 0x0C283FF RRQ.INV_I_TO_M

# Request insertions in the CHA's TOR (Table of Requests), in the
# IPQ (Ingress Probe Que). Cross-socket snoops from the home socket.
CHA TOR_INSERTS 0x08 0x0F803FF IPQ.SNP_CUR
CHA TOR_INSERTS 0x08 0x0F80BFF IPQ.SNP_CODE
CHA TOR_INSERTS 0x08 0x0F813FF IPQ.SNP_DATA
CHA TOR_INSERTS 0x08 0x0F81BFF IPQ.SNP_DATA_MIG
CHA TOR_INSERTS 0x08 0x0F823FF IPQ.SNP_INV_OWN
CHA TOR_INSERTS 0x08 0x0F82BFF IPQ.SNP_INV_I_TO_E

# Lookup in the LLC (RFO)
CHA LLC_LOOKUP 0xFF 0x1BC8 RFO
CHA LLC_LOOKUP 0x01 0x1BC8 RFO_MISS
CHA LLC_LOOKUP 0xFE 0x1BC8 _RFO_HIT
CHA LLC_LOOKUP 0xFF 0x1D88 _RFO_SNP

# Lookup in the LLC, remote socket origin, snoop or non-snoop type
CHA LLC_LOOKUP 0xFF 0x1C19 REMOTE_SNP
CHA LLC_LOOKUP 0xFF 0x1A19 _REMOTE_NON_SNP

# Lookup in the LLC, for line allocated in the local or in a remote NUMA node
CHA LLC_LOOKUP 0xFF 0x15DF REM_HOM
CHA LLC_LOOKUP 0xFF 0x0BDF LOC_HOM

# Lookup in the LLC (READ)
CHA LLC_LOOKUP 0xFE 0x1BD9 READ_HIT
CHA LLC_LOOKUP 0x01 0x1BD9 READ_MISS
CHA LLC_LOOKUP 0x0E 0x1BD9 READ_SF_HIT

# Lookup in the LLC found line in this state (or in case of I, didn't find the line)
CHA LLC_LOOKUP 0x01 0x1FFF I
CHA LLC_LOOKUP 0x10 0x1FFF S
CHA LLC_LOOKUP 0x20 0x1FFF E
CHA LLC_LOOKUP 0x40 0x1FFF M
CHA LLC_LOOKUP 0x80 0x1FFF F
CHA LLC_LOOKUP 0x02 0x1FFF SF_S
CHA LLC_LOOKUP 0x04 0x1FFF SF_E
CHA LLC_LOOKUP 0x08 0x1FFF SF_H

# Requests to the Home Agent part of the CHA. Keep in mind WRITES
# include HitM requests, i.e. requests that hit in the modified state
CHA REQUESTS 0x01 READS_LOCAL
CHA REQUESTS 0x02 READS_REMOTE
CHA REQUESTS 0x04 WRITES_LOCAL
CHA REQUESTS 0x08 WRITES_REMOTE
CHA REQUESTS 0x10 INVITOE_LOCAL
CHA REQUESTS 0x20 INVITOE_REMOTE
# CHA REQUESTS 0x03 READS
# CHA REQUESTS 0x0C WRITES
# CHA REQUESTS 0x30 INVITOE

# Opportunistic snoop broadcast
CHA OSB 0x01 LOCAL_INVITOE
CHA OSB 0x02 LOCAL_READ
CHA OSB 0x04 REMOTE_READ
CHA OSB 0x08 REMOTE_READ_INVITOE
CHA OSB 0x10 RFO_HITS_SNP_BCAST

# Lookup in the HitME cache
CHA HITME_LOOKUP 0x01 READ
CHA HITME_LOOKUP 0x02 WRITE

# Lookup in the HitME cache resulted in hit
CHA HITME_HIT 0x01 EX_RDS
CHA HITME_HIT 0x04 SHARED_OWNREQ
CHA HITME_HIT 0x08 WBMTOE
CHA HITME_HIT 0x10 WBMTOI_OR_S
CHA HITME_HIT 0xFF _
# 0xFF looks for undocuments umasks

# Lookup in the HitME cache resulted in miss
CHA HITME_MISS 0x20 SHARED_RDINVOWN
CHA HITME_MISS 0x40 NOTSHARED_RDINVOWN
CHA HITME_MISS 0x80 READ_OR_INV
CHA HITME_MISS 0xFF _
# 0xFF looks for undocuments umasks

# CHA-issued lookup of the in-memory directory
CHA DIR_LOOKUP 0x01 SNP
CHA DIR_LOOKUP 0x02 NO_SNP

# CHA-issued read for line from the memory
# CHA IMC_READS_COUNT 0x01 NORMAL
# CHA IMC_READS_COUNT 0x02 PRIORITY
CHA IMC_READS_COUNT 0xFF

# Some optimization; essentially equivalent to IMC_READS_COUNT
CHA BYPASS_CHA_IMC 0x01 TAKEN
# CHA BYPASS_CHA_IMC 0x02 INTERMEDIATE
# CHA BYPASS_CHA_IMC 0x04 NOT_TAKEN

# Cross-socket snoops issued
CHA SNOOPS_SENT 0x10 BCST_LOCAL
CHA SNOOPS_SENT 0x20 BCST_REMOTE
CHA SNOOPS_SENT 0x40 DIRECT_LOCAL
CHA SNOOPS_SENT 0x80 DIRECT_REMOTE
# CHA SNOOPS_SENT 0x01 ALL
# CHA SNOOPS_SENT 0x04 LOCAL
# CHA SNOOPS_SENT 0x08 REMOTE

# Cross-core snoops issued by the CHA (inside socket)
CHA CORE_SNP 0x11 REMOTE_ONE
CHA CORE_SNP 0x12 _REMOTE_GTONE
CHA CORE_SNP 0x21 EXT_ONE
CHA CORE_SNP 0x22 EXT_GTONE
CHA CORE_SNP 0x41 CORE_ONE
CHA CORE_SNP 0x42 CORE_GTONE
CHA CORE_SNP 0x81 EVICT_ONE
CHA CORE_SNP 0x82 EVICT_GTONE
# CHA CORE_SNP 0xF1 ANY_ONE
# CHA CORE_SNP 0xF2 ANY_GTONE

# Events beginning with '_' are experimental. XSNP is taken from the
# SKX manual. It's not present in the ICX manual, but appears to work.
# Responses from cores to the CHA, for previously issued cross-core snoops
CHA _XSNP_RESP 0x21 _EXT_RSP_HIT_FSE
CHA _XSNP_RESP 0x22 _EXT_RSPS_FWDFE
CHA _XSNP_RESP 0x24 _EXT_RSPI_FWDFE
CHA _XSNP_RESP 0x28 _EXT_RSPS_FWDM
CHA _XSNP_RESP 0x30 _EXT_RSPI_FWDM
CHA _XSNP_RESP 0x41 _CORE_RSP_HITFSE
CHA _XSNP_RESP 0x42 _CORE_RSPS_FWDFE
CHA _XSNP_RESP 0x44 _CORE_RSPI_FWDFE
CHA _XSNP_RESP 0x48 _CORE_RSPS_FWDM
CHA _XSNP_RESP 0x50 _CORE_RSPI_FWDM
CHA _XSNP_RESP 0x81 _EVICT_RSP_HITFSE
CHA _XSNP_RESP 0x82 _EVICT_RSPS_FWDFE
CHA _XSNP_RESP 0x84 _EVICT_RSPI_FWDFE
CHA _XSNP_RESP 0x84 _EVICT_RSPS_FWDM
CHA _XSNP_RESP 0x90 _EVICT_RSPI_FWDM

# Responses to cross-socket snoops
CHA SNOOP_RESP 0x01 RSP_I
CHA SNOOP_RESP 0x02 RSP_S
CHA SNOOP_RESP 0x04 RSP_I_FWD
CHA SNOOP_RESP 0x08 RSP_S_FWD
CHA SNOOP_RESP 0x10 RSP_WB
CHA SNOOP_RESP 0x20 RSP_FWD_WB
CHA SNOOP_RESP 0x40 RSP_CNFLCT
CHA SNOOP_RESP 0x80 RSP_FWD

# Responses to cross-socket snoops, which where issued
# in order to service requests of local origin
CHA SNOOP_RESP_LOCAL 0x01 RSP_I
CHA SNOOP_RESP_LOCAL 0x02 RSP_S
CHA SNOOP_RESP_LOCAL 0x04 RSP_I_FWD
CHA SNOOP_RESP_LOCAL 0x08 RSP_S_FWD
CHA SNOOP_RESP_LOCAL 0x10 RSP_WB
CHA SNOOP_RESP_LOCAL 0x20 RSP_FWD_WB
CHA SNOOP_RESP_LOCAL 0x40 RSP_CNFLCT
CHA SNOOP_RESP_LOCAL 0x80 RSP_FWD

# These show responses to cross-core snoops. But only some types?
# Is this supposed to replace XSNP_RESP on ICX?
CHA SNOOP_RSP_MISC 0x01 M_TO_I_RSP_I_FWD_M
CHA SNOOP_RSP_MISC 0x02 M_TO_I_RSP_DATA_M
CHA SNOOP_RSP_MISC 0x04 RSP_I_FWD_M_PTL_HIT_SF
CHA SNOOP_RSP_MISC 0x08 RSP_I_FWD_M_PTL_HIT_LLC
CHA SNOOP_RSP_MISC 0x10 PULL_DATA_PLT_HIT_SF
CHA SNOOP_RSP_MISC 0x20 PULL_DATA_PLT_HIT_LLC

# Update/insertion of an entry in the HitME cache
# Haven't really ever seen this...
CHA HITME_UPDATE 0x01 DEALLOCATE_RSPFWDI_LOC
CHA HITME_UPDATE 0x02 RSPFWDI_REM
CHA HITME_UPDATE 0x04 SHARED
CHA HITME_UPDATE 0x08 RDINVOWN
CHA HITME_UPDATE 0x10 DEALLOCATE
CHA HITME_UPDATE 0xFF

# CHA-issued update of the in-memory directory
CHA DIR_UPDATE 0x01 HA
CHA DIR_UPDATE 0x02 TOR

# CHA-issued write to line in the memory
# CHA IMC_WRITES_COUNT 0x01 FULL
# CHA IMC_WRITES_COUNT 0x02 PARTIAL
# CHA IMC_WRITES_COUNT 0x04 FULL_PRIORITY
# CHA IMC_WRITES_COUNT 0x08 PARTIAL_PRIORITY
CHA IMC_WRITES_COUNT 0xFF

# Read/Write memory operations (Column Address Strobe, not Compare And Swap!)
IMC CAS_COUNT 0x0F RD
IMC CAS_COUNT 0x30 WR

# Responses of cores to cross-core snoops from the CHA
CORE CORE_SNOOP_RESPONSE 0x01 MISS
CORE CORE_SNOOP_RESPONSE 0x02 I_HIT_FSE
CORE CORE_SNOOP_RESPONSE 0x04 S_HIT_FSE
CORE CORE_SNOOP_RESPONSE 0x08 S_FWD_M
CORE CORE_SNOOP_RESPONSE 0x10 I_FWD_M
CORE CORE_SNOOP_RESPONSE 0x20 I_FWD_FE
CORE CORE_SNOOP_RESPONSE 0x40 S_FWD_FE

# Disabled, way too noisy, e.g. due to polling of the cache_eng sync flag
# CORE MEM_LOAD_RETIRED 0x01 L1_HIT
# CORE MEM_LOAD_RETIRED 0x08 L1_MISS

# Core operations that looked up the L2, and their result
# CORE L2_RQSTS 0xE1 ALL_DEMAND_DATA_RD
# CORE L2_RQSTS 0x27 ALL_DEMAND_MISS
# CORE L2_RQSTS 0xE2 ALL_RFO
CORE L2_RQSTS 0xC1 DEMAND_DATA_RD_HIT
CORE L2_RQSTS 0x21 DEMAND_DATA_RD_MISS
CORE L2_RQSTS 0xC2 RFO_HIT
CORE L2_RQSTS 0x22 RFO_MISS

# Completed load operations that hit/missed the L2
CORE MEM_LOAD_RETIRED 0x02 L2_HIT
CORE MEM_LOAD_RETIRED 0x10 L2_MISS

# Operations that couldn't be satisfied inside the core,
# and went off it, to higher levels (e.g. CHA)
CORE OFFCORE_REQUESTS 0x01 DEMAND_DATA_RD
CORE OFFCORE_REQUESTS 0x04 DEMAND_RFO

# Operations that accessed the highest level cache (L3/LLC)
CORE LONGEST_LAT_CACHE 0x4F REFERENCE
CORE LONGEST_LAT_CACHE 0x41 MISS

# Completed load operations that hit/missed the L3/LLC
CORE MEM_LOAD_RETIRED 0x04 L3_HIT
CORE MEM_LOAD_RETIRED 0x20 L3_MISS

# Operations that couldn't be satisfied inside the core,
# and went off it, to higher levels (e.g. CHA)
CORE OFFCORE_REQUESTS 0x10 L3_MISS_DEMAND_DATA_RD

# Completed load operations that hit in L3 + extra information about
# whether the data was readily available in the L3, or cross-core
# snoops with/without data forwarding were necessary
CORE MEM_LOAD_L3_HIT_RETIRED 0x01 XSNP_MISS
CORE MEM_LOAD_L3_HIT_RETIRED 0x02 XSNP_NO_FWD
CORE MEM_LOAD_L3_HIT_RETIRED 0x04 XSNP_FWD
CORE MEM_LOAD_L3_HIT_RETIRED 0x08 XSNP_NONE

# Completed load operations that missse in L3 + extra
# information about where the data eventually came from
CORE MEM_LOAD_L3_MISS_RETIRED 0x01 LOCAL_DRAM
CORE MEM_LOAD_L3_MISS_RETIRED 0x02 REMOTE_DRAM
CORE MEM_LOAD_L3_MISS_RETIRED 0x04 REMOTE_HITM
CORE MEM_LOAD_L3_MISS_RETIRED 0x08 REMOTE_FWD

# L2 line insertions and evictions
CORE L2_LINES_OUT 0xFF
CORE L2_LINES_IN 0x1F
