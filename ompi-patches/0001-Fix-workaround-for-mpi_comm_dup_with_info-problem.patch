From 75c45c7ad3ace3dbbad0eafb7bd429940065c23b Mon Sep 17 00:00:00 2001
From: George Katevenis <gkatev@ics.forth.gr>
Date: Thu, 28 Apr 2022 16:42:18 +0000
Subject: [PATCH 1/3] Fix/workaround for mpi_comm_dup_with_info problem

---
 ompi/communicator/comm.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/ompi/communicator/comm.c b/ompi/communicator/comm.c
index 264c176..deb46cd 100644
--- a/ompi/communicator/comm.c
+++ b/ompi/communicator/comm.c
@@ -981,6 +981,7 @@ static int ompi_comm_split_type_core(ompi_communicator_t *comm,
     ompi_comm_assert_subscribe (newcomp, OMPI_COMM_ASSERT_LAZY_BARRIER);
     ompi_comm_assert_subscribe (newcomp, OMPI_COMM_ASSERT_ACTIVE_POLL);
     if (info) {
+        opal_info_dup(info, &newcomp->super.s_info);
         opal_infosubscribe_change_info(&newcomp->super, info);
     }
 
@@ -1337,6 +1338,7 @@ int ompi_comm_dup_with_info ( ompi_communicator_t * comm, opal_info_t *info, omp
     ompi_comm_assert_subscribe (newcomp, OMPI_COMM_ASSERT_LAZY_BARRIER);
     ompi_comm_assert_subscribe (newcomp, OMPI_COMM_ASSERT_ACTIVE_POLL);
     if (info) {
+        opal_info_dup(info, &newcomp->super.s_info);
         opal_infosubscribe_change_info(&newcomp->super, info);
     }
 
-- 
1.8.3.1

